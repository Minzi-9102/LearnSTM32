/*********************************************************************************************************
* 模块名称：SysTick.c
* 摘    要：SysTick模块，包含SysTick模块初始化以及微秒和毫秒级延时函数
* 当前版本：1.0.0
* 作    者：SZLY(COPYRIGHT 2018 - 2020 SZLY. All rights reserved.)
* 完成日期：2020年01月01日 
* 内    容：
* 注    意：                                                                  
**********************************************************************************************************
* 取代版本：
* 作    者：
* 完成日期：
* 修改内容：           
* 修改文件：
*********************************************************************************************************/

/*********************************************************************************************************
*                                              包含头文件
*********************************************************************************************************/
#include "SysTick.h"

/*********************************************************************************************************
*                                              宏定义
*********************************************************************************************************/

/*********************************************************************************************************
*                                              枚举结构体定义
*********************************************************************************************************/

/*********************************************************************************************************
*                                              内部变量
*********************************************************************************************************/
 static __IO u32 s_iTimDelayCnt = 0;
/*********************************************************************************************************
*                                              内部函数声明
*********************************************************************************************************/
static void TimDelayDec(void);
/*********************************************************************************************************
*                                              内部函数实现
*********************************************************************************************************/
/*********************************************************************************************************
* 函数名称：TimDelayDec
* 函数功能：
* 输入参数：
* 输出参数：
* 返 回 值：
* 创建日期：2018年01月01日
* 注    意：
*********************************************************************************************************/
static void TimDelayDec(void)
{
	if(s_iTimDelayCnt != 0)//延时计数器的数值不为0
	{
		s_iTimDelayCnt--;			//延时计数器的数值-1
	}
}

void SysTick_Handler(void)		//滴答定时器中断服务函数
{
	TimDelayDec();		//延时计数函数
}


/*********************************************************************************************************
*                                              API函数实现
*********************************************************************************************************/
/*********************************************************************************************************
* 函数名称：InitSysTick
* 函数功能：
* 输入参数：
* 输出参数：
* 返 回 值：
* 创建日期：2018年01月01日
* 注    意：
*********************************************************************************************************/
void InitSysTick(void)
{
	if(SysTick_Config(SystemCoreClock/1000))	//配置系统滴答定时器1ms中断一次
	{
		while(1)																//在发生错误的情况下，进入死循环
		{
		
		}
	}
}

/*********************************************************************************************************
* 函数名称：DelayNms
* 函数功能：
* 输入参数：
* 输出参数：
* 返 回 值：
* 创建日期：2018年01月01日
* 注    意：
*********************************************************************************************************/
void DelayNms(__IO u32 nms)
{
	s_iTimDelayCnt = nms;										//讲延时计数器s_iTimDelayCnt的数值赋值为nms
	
	while(s_iTimDelayCnt != 0)							//延时计数器的数值为0时，表示延时了nms，跳出while语句
	{
		
	}
}
/*********************************************************************************************************
* 函数名称：DelayNus
* 函数功能：
* 输入参数：
* 输出参数：
* 返 回 值：
* 创建日期：2018年01月01日
* 注    意：
*********************************************************************************************************/
void DelayNus(__IO u32 nus)
{
	u32 s_iTimCnt = nus;							//定义一个变量s_iTimCnt作为延时计数器，赋值为nus
	u16 i;														//定义一个变量作为循环计数器
	
	while(s_iTimCnt != 0)							//延时计数器s_iTimCnt的值不为0
	{
		for(i = 0;i < 7;i++)						//空循环，产生延时功能
		{
			
		}
		s_iTimCnt--;
	}
}
