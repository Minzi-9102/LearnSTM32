/*********************************************************************************************************
* 模块名称：IWDG.c
* 摘    要：IWDG模块
* 当前版本：1.0.0
* 作    者：SZLY(COPYRIGHT 2018 SZLY. All rights reserved.)
* 完成日期：2018年01月01日
* 内    容：
* 注    意：                                                                  
**********************************************************************************************************
* 取代版本：
* 作    者：
* 完成日期：
* 修改内容：
* 修改文件：
*********************************************************************************************************/

/*********************************************************************************************************
*                                              包含头文件
*********************************************************************************************************/
#include "IWDG.h"
#include "stm32f10x_conf.h"
/*********************************************************************************************************
*                                              宏定义
*********************************************************************************************************/

/*********************************************************************************************************
*                                              枚举结构体定义
*********************************************************************************************************/

/*********************************************************************************************************
*                                              内部变量
*********************************************************************************************************/
 
/*********************************************************************************************************
*                                              内部函数声明
*********************************************************************************************************/
static void ConfigIWDG(u8 prer,u16 rlr);//配置IWDG
/*********************************************************************************************************
*                                              内部函数实现
*********************************************************************************************************/
/*********************************************************************************************************
* 函数名称：ConfigIWDG
* 函数功能：
* 输入参数：
* 输出参数：
* 返 回 值：
* 创建日期：2018年01月01日
* 注    意：
*********************************************************************************************************/
static void ConfigIWDG(u8 prer,u16 rlr)
{
	//使能对寄存器IWDG_PR和IWDG_RLR的写操作，即可修改寄存器值
	IWDG_WriteAccessCmd(IWDG_WriteAccess_Enable);
	
	IWDG_SetPrescaler(prer);//设置IWDG预分频值
	
	IWDG_SetReload(rlr);//设置IWDG重装载值
	
	IWDG_ReloadCounter();//按照IWDG重装载寄存器的值重装载IWDG计数器
	
	IWDG_Enable();//使能IWDG
}
/*********************************************************************************************************
*                                              API函数实现
*********************************************************************************************************/
/*********************************************************************************************************
* 函数名称：InitIWDG
* 函数功能：
* 输入参数：
* 输出参数：
* 返 回 值：
* 创建日期：2018年01月01日
* 注    意：
*********************************************************************************************************/
void InitIWDG(void)
{
	ConfigIWDG(IWDG_Prescaler_64,624);
}

/*********************************************************************************************************
* 函数名称：FeedIWDG
* 函数功能：
* 输入参数：
* 输出参数：
* 返 回 值：
* 创建日期：2018年01月01日
* 注    意：
*********************************************************************************************************/
void FeedIWDG(void)
{
	IWDG_ReloadCounter();
}
